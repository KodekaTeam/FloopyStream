<!-- Desktop Sidebar -->
<aside
  class="hidden lg:flex lg:w-20 bg-gray-800 border-r border-gray-700 flex-col items-center py-6 space-y-8 fixed h-screen z-30"
>
  <!-- Logo -->
  <div class="text-blue-500 text-2xl cursor-pointer">
    <!-- <i class="ti ti-broadcast"></i> -->
    <img src="/images/favicon.ico" alt="Logo" class="w-16 h-16 mt-[-16px]" />
  </div>

  <!-- Navigation -->
  <nav class="flex-1 flex flex-col items-center space-y-4">
    <a
      href="/dashboard"
      class="w-16 h-16 flex flex-col items-center justify-center gap-1 rounded-lg <%= currentPage === 'dashboard' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-700 hover:text-white' %> transition"
      title="dashboard"
      aria-label="Streams"
    >
      <i class="ti ti-broadcast text-xl"></i>
      <span class="text-xs leading-tight">Streams</span>
    </a>
    <a
      href="/content"
      class="w-16 h-16 flex flex-col items-center justify-center gap-1 rounded-lg <%= currentPage === 'content' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-700 hover:text-white' %> transition"
      title="Content"
      aria-label="Gallery"
    >
      <i class="ti ti-video text-xl"></i>
      <span class="text-xs leading-tight">Gallery</span>
    </a>
    <a
      href="/playlists"
      class="w-16 h-16 flex flex-col items-center justify-center gap-1 rounded-lg <%= currentPage === 'playlists' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-700 hover:text-white' %> transition"
      title="Playlists"
    >
      <i class="ti ti-playlist text-xl"></i>
      <span class="text-xs leading-tight">Playlists</span>
    </a>
    <a
      href="/history"
      class="w-16 h-16 flex flex-col items-center justify-center gap-1 rounded-lg <%= currentPage === 'history' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-700 hover:text-white' %> transition"
      title="History"
    >
      <i class="ti ti-history text-xl"></i>
      <span class="text-xs leading-tight">History</span>
    </a>
    <!-- <a
      href="/channel-management"
      class="w-16 h-16 flex flex-col items-center justify-center gap-1 rounded-lg <%= currentPage === 'channel-management' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-700 hover:text-white' %> transition"
      title="Channel Management"
    >
      <i class="ti ti-device-tv text-xl"></i>
      <span class="text-xs leading-tight">Channel</span>
    </a> -->
    <% if (session.accountRole === 'admin') { %>
    <a
      href="/user-management"
      class="w-16 h-16 flex flex-col items-center justify-center gap-1 rounded-lg <%= currentPage === 'user-management' ? 'bg-blue-600 text-white' : 'text-gray-400 hover:bg-gray-700 hover:text-white' %> transition"
      title="User Management"
    >
      <i class="ti ti-users text-xl"></i>
      <span class="text-xs leading-tight">Members</span>
    </a>
    <% } %>
  </nav>

  <!-- Settings Button -->
  <a
    href="/settings"
    class="w-12 h-12 flex items-center justify-center rounded-lg text-gray-400 hover:bg-gray-700 hover:text-white transition"
    title="Settings"
  >
    <i class="ti ti-settings text-xl"></i>
  </a>
</aside>

<!-- Mobile Bottom Navigation -->
<nav
  class="lg:hidden fixed bottom-0 left-0 right-0 bg-gray-800 border-t border-gray-700 z-30 safe-area-bottom"
>
  <div class="flex items-center justify-around h-16">
    <a
      href="/dashboard"
      class="flex-1 flex flex-col items-center justify-center gap-1 <%= currentPage === 'dashboard' ? 'text-blue-500' : 'text-gray-400' %> transition"
    >
      <i class="ti ti-broadcast text-xl"></i>
      <span class="text-xs">Streams</span>
    </a>
    <a
      href="/content"
      class="flex-1 flex flex-col items-center justify-center gap-1 <%= currentPage === 'content' ? 'text-blue-500' : 'text-gray-400' %> transition"
    >
      <i class="ti ti-video text-xl"></i>
      <span class="text-xs">Gallery</span>
    </a>
    <a
      href="/playlists"
      class="flex-1 flex flex-col items-center justify-center gap-1 <%= currentPage === 'playlists' ? 'text-blue-500' : 'text-gray-400' %> transition"
    >
      <i class="ti ti-playlist text-xl"></i>
      <span class="text-xs">Playlist</span>
    </a>
    <a
      href="/history"
      class="flex-1 flex flex-col items-center justify-center gap-1 <%= currentPage === 'history' ? 'text-blue-500' : 'text-gray-400' %> transition"
    >
      <i class="ti ti-history text-xl"></i>
      <span class="text-xs">History</span>
    </a>
    <a
      href="#"
      onclick="toggleMobileProfileMenu(event)"
      class="flex-1 flex flex-col items-center justify-center mt-1.5 gap-1 text-gray-400 transition relative"
    >
      <div
        class="w-6 h-6 rounded-full bg-blue-600 flex items-center justify-center text-white text-xs font-bold"
      >
        <%= session.username.charAt(0).toUpperCase() %>
      </div>
      <span class="text-xs">Profile</span>
    </a>
  </div>
</nav>

<!-- Mobile Profile Menu -->
<div
  id="mobileProfileMenu"
  class="lg:hidden fixed bottom-16 right-4 bg-gray-800 border border-gray-700 rounded-lg shadow-xl z-40 hidden"
>
  <div class="p-4 border-b border-gray-700">
    <p class="text-white font-medium"><%= session.username %></p>
    <p class="text-xs text-gray-400"><%= session.email || 'User' %></p>
    <% if (session.accountRole === 'admin') { %>
    <span
      class="inline-block mt-2 px-2 py-1 bg-blue-500/20 text-blue-400 text-xs rounded-full"
    >
      <i class="ti ti-shield"></i> Admin
    </span>
    <% } %>
  </div>
  <div class="p-2">
    <!-- <a
      href="/channel-management"
      class="flex items-center gap-2 px-4 py-2.5 text-gray-300 hover:bg-gray-700 hover:text-white transition-colors block"
    >
      <i class="ti ti-device-tv text-lg"></i>
      <span>Channel</span>
    </a> -->
    <% if (session.accountRole === 'admin') { %>
    <a
      href="/user-management"
      class="flex items-center gap-2 w-64 px-4 py-2 text-gray-300 hover:bg-gray-700 rounded-lg transition"
    >
      <i class="ti ti-users"></i>
      <span>Members</span>
    </a>
    <% } %>
    <a
      href="/donate"
      class="flex items-center gap-2 px-4 py-2.5 text-gray-300 hover:bg-gray-700 hover:text-white transition-colors block"
    >
      <i class="ti ti-gift text-lg"></i>
      <span>Donate</span>
      <i class="ti ti-coin text-lg text-yellow-400"></i>
    </a>
    <a
      href="/settings"
      target="_blank"
      class="flex items-center gap-2 px-4 py-2 text-gray-300 hover:bg-gray-700 rounded-lg transition"
    >
      <i class="ti ti-settings"></i>
      <span>Settings</span>
    </a>
    <a
      href="/aboutus"
      target="_blank"
      class="flex items-center gap-2 px-4 py-2.5 text-gray-300 hover:bg-gray-700 hover:text-white transition-colors block"
    >
      <i class="ti ti-info-circle text-lg"></i>
      <span>About us</span>
    </a>

    <div class="border-t border-gray-700 my-2"></div>

    <a
      href="/logout"
      class="flex items-center gap-2 px-4 py-2 text-red-400 hover:bg-gray-700 rounded-lg transition"
    >
      <i class="ti ti-logout"></i>
      <span>Logout</span>
    </a>
  </div>
</div>

<style>
  /* Safe area for devices with notch */
  .safe-area-bottom {
    padding-bottom: env(safe-area-inset-bottom);
  }

  /* Ensure content doesn't go under bottom nav on mobile */
  @media (max-width: 1023px) {
    body {
      padding-bottom: calc(4rem + env(safe-area-inset-bottom));
    }
  }
</style>

<script>
  // Toggle mobile profile menu
  function toggleMobileProfileMenu(event) {
    event.preventDefault();
    const menu = document.getElementById("mobileProfileMenu");
    menu.classList.toggle("hidden");
  }

  // Close profile menu when clicking outside
  document.addEventListener("click", function (event) {
    const menu = document.getElementById("mobileProfileMenu");
    const target = event.target.closest("a");

    if (
      menu &&
      !menu.contains(event.target) &&
      (!target || !target.hasAttribute("onclick"))
    ) {
      menu.classList.add("hidden");
    }
  });
</script>
